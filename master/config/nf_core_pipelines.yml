# nf-core Pipeline Configuration
#
# This file allows manual override of nf-core pipeline settings.
# API-fetched values are used by default, but settings here take precedence.
#
# === Input Types ===
# Different nf-core pipelines expect different input formats:
#   - samplesheet: Standard CSV with sample info (default for most pipelines)
#   - id_list: Text file with accession IDs (e.g., fetchngs)
#   - fasta_list: Text file with FASTA file paths
#   - custom: Pipeline-specific format
#
# If input_type is not specified, it will be auto-detected from schema_input.json
#
# === Samplesheet Mapping ===
# Maps SUSHI dataset columns to nf-core samplesheet columns.
# Format: nf_core_column: sushi_column
#
# === Custom Parameters ===
# Define pipeline-specific parameters that aren't in the standard schema.
#
pipelines:
  # ============================================================
  # rnaseq - RNA sequencing analysis
  # ============================================================
  rnaseq:
    nf_core_name: rnaseq
    default_version: "3.14.0"  # Nextflow 24.x compatible (3.22.2 requires Nextflow 25.04+)
    analysis_category: Transcriptomics
    input_type: samplesheet
    use_ref_selector: true  # Use SUSHI's standard reference selector
    samplesheet_mapping:
      sample: Name
      fastq_1: "Read1 [File]"
      fastq_2: "Read2 [File]"
      strandedness: StrandMode
    custom_params:
      # Workaround for STAR segfault issue - use Salmon pseudo-aligner
      - name: pseudo_aligner
        type: select
        required: false
        options: ["", "salmon"]
        default: "salmon"
        description: "Use Salmon pseudo-aligner instead of STAR (workaround for STAR crash)"
      - name: skip_alignment
        type: select
        required: false
        options: ["", "true"]
        default: "true"
        description: "Skip STAR alignment (use when pseudo_aligner is set to salmon)"
    params:
      cores: 8
      ram: 64  # STAR genome index generation requires ~40GB+ for mammalian genomes
      scratch: 200

  # ============================================================
  # fetchngs - Fetch data from public databases
  # ============================================================
  fetchngs:
    nf_core_name: fetchngs
    input_type: id_list
    analysis_category: DataFetch
    skip_multiqc: true  # fetchngs doesn't generate MultiQC report
    custom_params:
      - name: accession_ids
        type: text_area
        required: true
        default: ""
        description: "Enter SRA/ENA/GEO/DDBJ accession IDs separated by comma or space (e.g., SRR9984183,ERR1160846,GSM4432381)"
    params:
      cores: 4
      ram: 16
      scratch: 500

  # ============================================================
  # chipseq - ChIP-seq analysis
  # ============================================================
  chipseq:
    nf_core_name: chipseq
    input_type: samplesheet
    analysis_category: Epigenetics
    samplesheet_mapping:
      sample: Name
      fastq_1: "Read1 [File]"
      fastq_2: "Read2 [File]"
      antibody: Antibody
      control: Control
    params:
      cores: 8
      ram: 30
      scratch: 100

  # ============================================================
  # atacseq - ATAC-seq analysis
  # ============================================================
  atacseq:
    nf_core_name: atacseq
    input_type: samplesheet
    analysis_category: Epigenetics
    samplesheet_mapping:
      sample: Name
      fastq_1: "Read1 [File]"
      fastq_2: "Read2 [File]"
    params:
      cores: 8
      ram: 30
      scratch: 100

  # ============================================================
  # sarek - Variant calling pipeline
  # ============================================================
  sarek:
    nf_core_name: sarek
    input_type: samplesheet
    analysis_category: Genomics
    samplesheet_mapping:
      patient: Patient
      sample: Name
      lane: Lane
      fastq_1: "Read1 [File]"
      fastq_2: "Read2 [File]"
    params:
      cores: 8
      ram: 64
      scratch: 200

  # ============================================================
  # smrnaseq - Small RNA-seq analysis
  # ============================================================
  smrnaseq:
    nf_core_name: smrnaseq
    default_version: "2.4.0" # version 2.4.1 might require newer nextflow
    input_type: samplesheet
    analysis_category: Transcriptomics
    use_ref_selector: true
    samplesheet_mapping:
      sample: Name
      fastq_1: "Read1 [File]"
      fastq_2: "Read2 [File]"
    custom_params:
      - name: mirtraceSpecies
        type: select
        required: true
        options: ["hsa", "mmu", "rno", "ath", "dme", "cel", "dre", "gga", "bta", "cfa", "eca", "ssc", "oar", "cgr", "ptr", "mcc", "mdo", "mne", "mpo", "mro", "mrs", "mvi", "oan", "ocu", "oha", "oja", "ola", "oni", "opr", "osl", "ota", "oto", "pab", "pan", "pma", "pmo", "ppy", "ptr", "rbi", "rno", "ssc", "tch", "tgu", "tni", "tru", "tup", "vpa", "xla", "xtr", "zma"]
        default: "hsa"
        description: "3-letter species code for miRBase (hsa=human, mmu=mouse, rno=rat, ath=arabidopsis, etc.)"
    params:
      cores: 16  # bowtie-build requires 12 threads, so set to 16 for safety
      ram: 80    # bowtie-build INDEX_GENOME requires 72 GB
      scratch: 100

  # ============================================================
  # taxprofiler - Taxonomic profiling
  # ============================================================
  taxprofiler:
    nf_core_name: taxprofiler
    input_type: samplesheet
    analysis_category: Metagenomics
    samplesheet_mapping:
      sample: Name
      fastq_1: "Read1 [File]"
      fastq_2: "Read2 [File]"
    params:
      cores: 8
      ram: 64
      scratch: 200

# ============================================================
# Default settings for pipelines not explicitly configured
# ============================================================
defaults:
  input_type: auto  # Will be detected from schema_input.json
  samplesheet_mapping:
    sample: Name
    fastq_1: "Read1 [File]"
    fastq_2: "Read2 [File]"
  params:
    cores: 8
    ram: 30
    scratch: 100
